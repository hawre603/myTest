<!DOCTYPE html>
<head>
<title></title>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<style>
      html, body{
        height: 100%;
        margin: 0px;
        padding: 0px
      }
	  #map-page { width: 100%; height: 100%; padding: 0; }
	  #map-canvas{ width: 100%; height:80%; padding: 0; }
    </style><link rel='stylesheet' href='http://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.css' />
<script src='https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=geometry'></script>

<script src='http://code.jquery.com/jquery-1.9.1.min.js'></script>

<script src='http://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.js'></script>

<script src='https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false'></script>
<script src='http://jquery.bassistance.de/validate/jquery.validate.js'></script>

<script src='http://jquery.bassistance.de/validate/additional-methods.js'></script>

<link rel='stylesheet' href='http://jquery.bassistance.de/validate/demo/site-demos.css'/>
<link rel='stylesheet' type='text/css' href='../appStyling.css'/>
 

<script>
        
     $( document ).on( 'pageinit', '#map-page', function() {
		 
		 var currentLatlng;
		var otherLatlng = new google.maps.LatLng('','');
		
    if ( navigator.geolocation ) {
        function success(pos) {
			 currentLatlng=new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude);
		drawMap(currentLatlng);
        }
		function fail(error) {
            drawMap(defaultLatLng);  // Failed to find location, show default map
        }
		
		// Find the users current position.  Cache the location for 5 minutes, timeout after 6 seconds
        navigator.geolocation.getCurrentPosition(success, fail, 
		{maximumAge: 500000, enableHighAccuracy:true, timeout: 6000});
    } else {
        drawMap(defaultLatLng);  // No geolocation support, show default map
    }
    function drawMap(currentLatlng) {
        var myOptions = {
            zoom: 13,
            center: currentLatlng,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var map = new google.maps.Map(document.getElementById('map-canvas'), myOptions);
        // Add an overlay to the map of current lat/lng
        var marker = new google.maps.Marker({
            position: currentLatlng,
            map: map,
            title: 'Current Location!'
        });

		
		var imgIcon ='../admin/icons/map-marker.png';
		var marker1 = new google.maps.Marker({
            position: otherLatlng,
            map: map,
			icon : imgIcon,
            title: ''
        });
		
		 var contentString1='<div id=content><div id=siteNotice><p>New Walk Museum and Art Gallery</p><p><a href=.html#detail-page>Click for more detail</a></p></div></div>';
		var infowindow1 = new google.maps.InfoWindow({
		content: contentString1
		});
		
		var infowindowCurrent = new google.maps.InfoWindow({
		content: 'Current Location!'
		});
		
		google.maps.event.addListener(marker, 'click', function() {
		infowindowCurrent.open(map,marker);});
		
		google.maps.event.addListener(marker1, 'click', function() {
		infowindow1.open(map,marker1);
		
		});
		
		
		var locBounds = new google.maps.LatLngBounds();
		locBounds.extend(otherLatlng);
		locBounds.extend(currentLatlng);
		//map.setCenter(locBound.getCenter());
   		map.fitBounds(locBounds);
     $('#dist').click(function(){
			var distance = calculateDistance();
			
			if(distance>150)
			{
				alert('You are not arrived the place yet!');
				window.location.href = '.html';
			}});
			
		//Get the distance between current location and other place
		function calculateDistance()
    	{
        try
        { 
           var dist = google.maps.geometry.spherical.computeDistanceBetween(currentLatlng, otherLatlng);
		   return dist;
        }
        catch (error)
        {
            alert(error);
        }
    }}        
});
          
    </script>







		
		</head> 
<body> 
 <form action='scripts/submit.php' id='guide' enctype='multipart/form-data' data-ajax='false' method='POST'>
 <input type='hidden' name='guide' value=''> <input type='hidden' name='filename' value=''>
<div data-role='page' id='map-page' data-url='map-page'>
		  
			<div data-role='header' data-theme='a'>
			<h1>Location Map Guide</h1>
			</div>
			<div role='main' class='ui-content' id='map-canvas'>
				<!-- map loads here... -->
			</div>
			<div data-role='navbar' style='text-align:center'>
<ul>
<li><a href='index.php'> Back</a></li>
<li><a href ='#detail-page' rel='external'> Next</a> </li>
</ul>
</div>
		</div>
		
		<div data-role='page' id='detail-page'>
		<div data-role='header' data-position='fixed'> <a href='#map-page' data-icon='home'
		data-iconpos='notext' data-rel='back'>Home</a>
		<h1> </h1> </div><!-- /header -->
		<div data-role='content'> 
		<div class='ui-corner-all ui-shadow outerDiv'>
		<div class='ui-corner-all ui-shadow innerDiv'> 
		
		<input type='hidden' name='QueimageLocation' value=''>
		<img src='../admin/uploadedmedia/' width='100%'>
<hr class='imgBorder'><br><hr>

		<label></label><br><hr>

		<input type='hidden' name='address' value=''>
		<label></label>


		<div data-role='navbar' style='text-align:center'>
<ul>
<li><a href='#map-page'> Back</a></li>
<li><a href ='#infopage' rel='external' id='dist'> Next</a>  </li>
</ul>
</div></div></div></div></div><!-- end of detail page -->
<div data-role='page' id='infopage' >
<div data-role='content'>
<div class='ui-corner-all ui-shadow outerDiv'>
<div  class='ui-corner-all ui-shadow innerDiv'>
How old are you? 
<ul data-role='listview' data-inset='true'>
<li><input type ='number'  name ='AGE' id='AGE'></li>
</ul>
What is your postcode?
 <ul data-role='listview' data-inset='true'> 
<li><input type ='text' maxlength='10' name ='POSTCODE' id='POSTCODE'></li>
</ul>
If you would like us to email you your completed guide, enter your email below.
<ul data-role='listview' data-inset='true'> 
<li><input type ='email' maxlength='30' id='email' name ='EMAIL'></li>
 </ul><input type='checkbox' name='saveEmail'>
<p style='padding-left:40px;'>Tick this box if you would like your email to be saved in order to receive e-mails from NewWalk Museum regarding...</p> 
<div data-role='navbar' style='text-align:center' data-position='fixed'>
 <ul>
 <li>
 <a href='#page'> Back</a>
 </li> 
<li> <input type='submit' data-corners='false' value ='Finish'>
</li>
</ul>
</div>
</div>
</div></div></div>
</form>
<script>
$( '#guide' ).validate({
  rules: { AGE: { required: true, min: 4, max: 99 },
	POSTCODE: {required:true,minlength:5},
	email: {required: true,email:true}
}  });
</script></body>
</html>>